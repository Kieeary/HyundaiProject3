<html lang="ko" class="back" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="wck/includes/head :: head_tag(title='배송 | 더한섬닷컴')"></th:block>
<script type="text/javascript" th:src="@{/js/layers.js}"></script>


<body class="back">
  <style>
    .general_pay_list.gpd_tab_w3 li {
      width: 50%;
    }
  </style>

  <script type="text/javascript">

    function submitOrder() {
      let payPrice = parseInt($("#afterprice").val());
      console.log(payPrice);

      if (payPrice < parseInt('0')) {
        layerAlert('구매하실 수 없는 조건입니다.');
        return;
      }

      let rcptName = $("#rcpt_name").val();
      console.log('수령인 이름 : '+rcptName);

      let phone = $("#hp0 option:selected").val();
      phone += $("#hp1").val();
      phone += $("#hp2").val();
      $("#phone").val(phone);
      console.log('선택된 번호 : '+phone);

      let zipcode = $("#zipcode").val();
      console.log('우편 주소 : ' + zipcode);
      console.log('첫 주소 : ' + $('#address1').val());
      console.log('나머지 주소 : ' + $('#address2').val());

      let memo = $("input[type=radio][name='gl_radio_dlvr_msg']:checked").val();
      console.log('메모 내역 : '+memo);
      let enter_door = $("input[type=radio][name='frontDoorSelectMessage']:checked").val();
      console.log('현관 : '+enter_door);

      let cpid = $("#voucherCode").val();
      console.log('쿠폰 코드 : '+cpid);

      let mileage = $("#useMileage").val();
      console.log('마일리지 : '+mileage);

      if ($("#zipcode").val() == '') {
        layerAlert("배송지 주소 우편번호를 입력해 주세요.");
        return;
      }

      if ($('#address1').val() == '') {
        layerAlert("배송지 주소 첫번째 주소를 입력해 주세요.");
        $('#address1').focus();
        return;
      }

      if ($("#rcpt_name").val() == '') {
        layerAlert("수령인을 입력해 주세요.");
        $('#rcpt_name').focus();
        return;
      }

      if (!$('#agree').is(":checked")) {
        layerAlert("구매자 동의 항목을 체크하여 주세요.");
        $('#agree').focus();
        return;
      }

      doOrder();
    }

    function selectPMCompany(obj) {
      $("#pmCompany").val($(obj).data('kind'));
    }

    function doOrder() {
      console.log('진짜 주문 시작');

      // 결제 API
      // $.ajax({
      //   type: "GET",
      //   url: "/wck/checkout/orderConfirmation",
      //   dataType: "applcation/json",
      //   success: function () {
      //     console.log('컨트롤러 넘거가기 성공');
      //   },
      //   error: function () {
      //   }
      // })
      let pmCode = $("#pmCode").val();
      console.log(pmCode);

      $("#orderForm").submit();
    }

    function calculateDueAmount() {
      // 쿠폰 할인액 계산
      let couponDue = parseInt($("#selectVoucher option:selected").data('code'));
      if (couponDue < 100) {
        couponDue = parseInt($("#beforeprice").val()) * couponDue / 100.0;
      }
      console.log('C :' + couponDue);

      // 마일리지 할인액 계산
      let mileageDue = parseInt($("#useMileage").val());
      console.log('M : ' + mileageDue);

      console.log('총 할인액 : ' + (couponDue + mileageDue));

      let totalDueAmount = couponDue + mileageDue;
      let sumProdPrice = parseInt($("#beforeprice").val());
      let afterPrice = sumProdPrice - totalDueAmount;
      if (sumProdPrice < 30000) {
        afterPrice += parseInt('2500');
      }
      $("#afterprice").val(afterPrice);

      $("#ttpd_con2").html(`- ₩${totalDueAmount.toLocaleString('ko-KR')}`);
      $(".pay_price").html(`₩${afterPrice.toLocaleString('ko-KR')}`);
      $("#doOrderBtn").html(`<span><b>${afterPrice.toLocaleString('ko-KR')}</b>원&nbsp;주문하기</span>`);
    }

    function selectVoucher() {
      let btn = $('.coupon_insert').children('.btnstl2');

      if (btn.html() != '취소') {
        // 쿠폰 사용함        
        btn.html('취소');
      } else {
        // 쿠폰 사용하지 않음
        btn.html('적용');
        $("#voucherCode").val("");
        $("#selectVoucher option:selected").attr("checked", false);
      }
    }

    function checkVoucher() {
      let selected = $("#selectVoucher option:selected").val();
      let cpCode = $("#voucherCode");
      cpCode.val(selected);

      let dueAmount = $("#selectVoucher option:selected").data('code');
      dueAmount = parseInt(dueAmount);
      console.log('data-code : ' + dueAmount);

      let btn = $('.coupon_insert').children('.btnstl2');
      if (selected == '') {
        // 쿠폰 사용 안힘
        btn.html('적용');
        cpCode.val("");
        // console.log('쿠폰 미사용');
      } else {
        // 쿠폰 사용
        btn.html('취소');
        // console.log('쿠폰 사용');

        // 프로모션/쿠폰 사용 가격 계산
        let originPrice = parseInt($("#beforeprice").val());
        if (dueAmount < 100) {
          // 정률 할인
          dueAmount = originPrice * dueAmount / 100.0;
        }
        // console.log('쿠폰 할인가 : '+dueAmount);
      }

      calculateDueAmount();
    }

    function selectMileage() {
      let mileage = $("#useMileage").val();
      let maxMileage = $("#useMileage");
      console.log($(maxMileage).data('max'));

      if($(maxMileage).data('max') < mileage) {
        layerAlert('보유 마일리지를 초과하여 사용할 수 없습니다.');
        $("#useMileage").val("0");
        $('#mpg_all_use_2').attr('checked', false);
        return;
      }

      let btn = $('.mpg_input').children('.btnstl2');
      if (btn.html() != '취소') {
        // 마일리지 사용함
        btn.html('취소');
      } else {
        // 마일리지 사용
        btn.html('적용');
        $("#useMileage").val("0");
        $('#mpg_all_use_2').attr('checked', false);
      }
      calculateDueAmount();
    }

    function checkMileage() {
      console.log('checkMileage');
      if ($('#mpg_all_use_2').is(':checked')) {
        // checked
        $("#useMileage").val('[[${mem.mileage}]]');
      } else {
        // un-checked
        $("#useMileage").val("0");
        $('.mpg_input').children('.btnstl2').html('적용');
      }
    }

    function chkword(targetID,lengthID,maxLength){
      var strValue = $('#'+targetID).val();
      var strLen = strValue.length;
      var maxByte = parseInt(maxLength);
      var str2 = "";

      if(strLen > maxByte){
          layerAlert(maxByte + "자를 초과 입력 할 수 없습니다.");
          str2 = strValue.substr(0, maxByte);
          $('#'+targetID).val(str2);
          strLen = str2.length;
      }

      $('#'+lengthID).text(strLen);
    }

    // function uuidv4() {
    //   return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
    //     (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
    //   );
    // }

    function uuidv4() { 
    return 'xxxx-xxxx-4xxx-yxxx-xxxx'.replace(/[xy]/g, function(c) { 
        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8); return v.toString(16); 
    }); 
} 
console.log(uuidv4());

  </script>

  <script th:inline="javascript">

    $(document).ready(function () {
      let beforePrice = 0;

      [# th:each = "prod, i : ${prods}"]
      console.log([[${prod}]]);
      beforePrice += [[${ prod.pcPrice * prod.quantity }]];
      [/]

      let pmCode = uuidv4();
      console.log(pmCode);
      $("#pmCode").val(pmCode);

      let afterPrice = beforePrice;
      if (beforePrice > 30000) {
        $("#ttpd_con3").html('₩ 0');
      } else {
        $("#ttpd_con3").html('₩ 2,500');
        afterPrice += parseInt('2500');
      }
      $("input[name='beforeprice']").val(beforePrice);
      let addMileage = beforePrice * parseFloat('[[${rate}]]');
      $("input[name='afterprice']").val(afterPrice);
      beforePrice = beforePrice.toLocaleString('ko-KR');
      afterPrice = afterPrice.toLocaleString('ko-KR');
      addMileage = addMileage.toLocaleString('ko-KR');
      $("#ttpd_con1").html(`₩ ${beforePrice}`);
      $(".pay_price").html(`₩ ${afterPrice}`);
      $("#doOrderBtn").html(`<span><b>${afterPrice}</b>원&nbsp;주문하기</span>`);
      $("#txtAccumulationPoint").html(`${addMileage}`);

      $("input:checkbox").on('click', function () {
        let mileage = $("#useMileage").val();
        console.log("M : " + mileage);

      })
    })

  </script>

  <!-- ########## loading start ########## -->
  <div style="display: none">
    <div id="loadingBarDiv" style="display: none"></div>
  </div>
  <!-- ########## loading start ########## -->

  <div id="mapleMainPopwrap" style="
        position: fixed;
        top: 50%;
        left: 50%;
        width: 81.333333%;
        z-index: 805;
        transform: translate(-50%, -50%);
        display: none;
      "></div>

  <div class="layerArea" id="mapleLayer" style="display: none">
    <div class="layerBg"></div>
  </div>

  <!-- ########## hsome_allContents_wrapper ########## -->
  <div class="hsome_allContents_wrapper">
    <div class="hsome_allContents fixed_btn_on">

      <!-- ########## header start ########## -->
      <header class="hsome_header">
        <h1 class="h_ttl ellipsis" id="headerTitle">배송&amp;결제정보 입력</h1>
        <a href="#" class="h_top_home"><span>홈</span></a>
        <a href="#" onclick="goBack();" class="h_prev">이전 페이지로 가기</a>
        <ul class="h_gnbMenu">
          <li class="search">
            <a href="#" onclick=""><span>search</span></a>
          </li>
          <li class="cart">
            <a href="/wck/shoppingbag"><span>cart</span><i>$$</i></a>
          </li>
        </ul>
      </header>
      <!-- ########## header end ########## -->

      <!-- ########## contents start ########## -->
      <div id="contents" class="hsome_contents delivery_payment_wrap">

        <form id="orderForm" th:object="${insertOrder}" action="/wck/checkout/orderConfirmation" method="post"><!-- 상품 리스트 -->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

          <!-- ########## product list start ########## -->
          <div id="checkoutCartView">

            <!-- ########## df_box div start ########## -->
            <div id="__div_sl" class="df_box df_box_slide">
              <h3 class="df_box_tit">
                주문상품<span class="df_box_tit_sub">([[${prods.size}]]개)</span>
              </h3>

              <!-- ########## Goods list start ########## -->
              <ul class="order_gl_item goods_list_wrap">
                <th:block th:if="${#lists.size(prods)!=0}" th:each="prod, i : ${prods}">
                  <div th:if="${i.first}">
                    <!-- ########## main goods info ########## -->
                    <li class="ogl_main_item item_info">
                  </div>
                  <div th:if="${!i.first}">
                    <!-- ########## sub goods info ########## -->
                    <li class="ogl_sub_item df_box_slide_con item_info" style="display: none;">
                  </div> 
                  
                  <input type="hidden" name="psids" th:value="${prod.psId}"/>
                  <input type="hidden" name="counts" th:value="${prod.quantity}"/>
                  <a href="#">
                    <div class="ogl_item gl_item">
                      <div class="gl_tit">
                        <img th:src="${prod.pImg}" alt="" class="gl_thumbimg" />
                      </div>
                      <ul class="gl_con">
                        <li class="gl_con_brand">[[${prod.bName}]]</li>

                        <li class="gl_con_name">
                          [[${prod.pName}]]
                        </li>
                        <li class="gl_con_option">[[${prod.colorName}]] / [[${prod.pSize}]] / [[${prod.quantity}]]개</li>
                        <li class="gl_con_price"><span> ₩[[${#numbers.formatInteger(prod.pcPrice, 3, 'COMMA')}]]</span>
                        </li>
                      </ul>
                    </div>
                  </a>
                  </li>
                  <!-- ########## main goods info end ########## -->

                </th:block>
              </ul>
              <!-- ########## Goods list end ########## -->

              <div class="check_stl shoppingbag_add_check_wrap" onclick="$('#packopt').click();">
                <input type="checkbox" name="pack_option" id="packopt" />
                <label for="shoppingbag_add_check" class="shoppingbag_add_check">친환경 쇼핑백을 추가합니다. (무료)
                  <span class="dpIB">
                    <div class="icon_help btn_tooltip" data-tooltip-target="tooltip_shoppingbag_add"></div>
                  </span>
                  <div class="tooltip_contens"></div>
                </label>
              </div>

              <!-- ########## order tootip start ########## -->
              <div class="tooltip_html">
                <div class="tooltip_wrap tooltip_shoppingbag_add">
                  <div class="tltp_close_btn btn_tltp_close">
                    <span>닫기</span>
                  </div>
                  <h1 class="tltp_header">쇼핑백추가</h1>
                  <div class="tltp_content">
                    <div class="shoppingbag_img">
                      <img src="http://www.thehandsome.com/_ui/handsomemobile/images/order/img_shoppingbag.jpg"
                        alt="쇼핑백" />
                    </div>
                    <ul class="ul_dot_blk">
                      <li>
                        선물용이나 이동 시 사용할 수 있는, 재활용이 가능한
                        친환경 쇼핑백을 드립니다.
                      </li>
                      <li>
                        더한섬닷컴 전용 친환경 쇼핑백만 발송되며, 브랜드
                        쇼핑백은 발송이 어렵습니다.
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <!-- ########## order (?) tootip end ########## -->

            </div>
            <!-- ########## df_box div start ########## -->
          </div>
          <!-- ########## product list end ########## -->
        


        <!-- ########## buyer info start ########## -->
        <div class="df_box orderer_info_input_wrap">
          <h3 class="df_box_tit">주문자 정보</h3>
          <table class="input_table">
            <colgroup>
              <col width="25%" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <th><label for="ordrr_name">주문자</label></th>
                <td><span class="view_data">[[${mem.name}]]</span></td>
              </tr>
              <tr>
                <th><label for="ordrr_phone">휴대폰</label></th>
                <td>
                  <ul class="input_phone_stl">
                    <li class="inp_phone1">
                      <div class="select_box">
                        <select id="hp0" name="hp0_num1" title="휴대폰 번호 앞자리">
                          <option value="010">010</option>
                          <option value="011">011</option>
                          <option value="016">016</option>
                          <option value="017">017</option>
                          <option value="018">018</option>
                          <option value="019">019</option>
                        </select>
                      </div>
                    </li>
                    <li class="inp_phone2">
                      <input type="tel" name="hp0_num2" id="hp1" title="휴대폰 번호 가운데자리" maxlength="4" autocomplete="nope"
                        th:placeholder="${#strings.substring(mem.phone, 3, 7)}" th:value="${#strings.substring(mem.phone, 3, 7)}"/>
                    </li>
                    <li class="inp_phone3">
                      <input type="tel" name="hp0_num3" id="hp2" title="휴대폰 번호 뒷자리" maxlength="4" autocomplete="nope"
                        th:placeholder="${#strings.substring(mem.phone, 7, 11)}" th:value="${#strings.substring(mem.phone, 7, 11)}" />
                    </li>
                  </ul>
                  <!-- <p class="err_box" id="hpMsg">영문/숫자/특수문자가능(4자~15자)</p> -->
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- ########## buyer info end ########## -->

        <!-- ########## shipping info start ########## -->
        <div class="df_box">
          <h3 class="df_box_tit">
            배송지 정보
            <span class="dpIB">
              <div class="icon_help btn_tooltip" data-tooltip-target="tooltip_deliverymode_info"></div>
            </span>
            <!-- tootip : contents_area s -->
            <div class="tooltip_contens">
              <div class="tooltip_wrap tooltip_deliverymode_info" style="display: none;">
                <div class="tltp_close_btn btn_tltp_close">
                  <span>닫기</span>
                </div>
                <h1 class="tltp_header">포인트 사용</h1>
                <div class="tltp_content">
                  <ul class="ul_dot_blk">
                    <li>
                      기본배송지 변경은
                      <strong>마이페이지&gt; [배송지관리]</strong>에서
                      가능합니다.
                    </li>
                    <li>
                      기본배송지 설정 시 기본배송지가 최우선으로 노출
                      됩니다.
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <!-- tootip : contents_area e -->
            <!-- tootip e -->
          </h3>
          <!-- tootip : contents_area e -->
          <!-- select_list : 배송지리스트 s -->

          <h3 class="df_box_tit rcpt_info" style="margin-top: 25px;"> 수령인 </h3>
          <div class="ip_rcpt">
            <input type="text" id="rcpt_name" name="rcpt_name" th:value="${mem.name}" >
          </div>

          <h3 class="df_box_tit ipt_tit" style="margin-top: 25px;"> 주소 </h3>
          <div class="ipt_con">
            <div style="margin-bottom: 5px; display: flex">
              <input style="width: 40%" type="text" id="zipcode" name="zipcode" th:value="${mem.zipcode}" readonly="">
              <button id="zip_btn" style="
                        border: 1px solid gray;
                        padding: 0px 5px;
                        margin-left: 5px;
                      ">
                주소찾기
              </button>
            </div>
            <input style="margin-bottom: 5px" type="text" id="address1" name="address1" readonly="" th:value="${mem.address1}">
            <input type="text" id="address2" name="address2" th:value="${mem.address2}" >
          </div>

          <!-- 211026 공동현관 출입방법 S -->
          <h3 class="df_box_tit enter-door211026">
            배송 요청사항
            <!-- tootip s -->
            <span class="dpIB">
              <div class="icon_help btn_tooltip" data-tooltip-target="tooltip_discout_info2"></div>
            </span>
            <!-- tootip : contents_area s -->
            <div class="tooltip_contens">
              <div class="tooltip_wrap tooltip_discout_info2" style="display: none">
                <div class="tltp_close_btn btn_tltp_close">
                  <span>닫기</span>
                </div>
                <h1 class="tltp_header">배송요청사항</h1>
                <div class="tltp_content">
                  <ul class="ul_dot_blk">
                    <li>
                      공동현관 출입번호가 정확하지 않을 경우, 배송 기사의
                      판단에 따라 1층 공동현관 앞 또는 경비실에 배송될 수
                      있습니다.
                    </li>
                    <li>새벽배송 시 배송 전 연락을 드리지 않습니다.</li>
                  </ul>
                </div>
              </div>
            </div>
            <!-- tootip : contents_area e -->
            <!-- tootip e -->
          </h3>
          <!-- 211026 공동현관 출입방법 E-->
          <div class="select_list_wrap select_list_dlvr_msg">
            <!-- select_list : selected_item s -->
            <div class="slcted_item">
              <div class="slct_con">
                <span class="gray_fc">배송메세지를 선택해주세요. (선택)</span>
              </div>
            </div>
            <!-- select_list : selected_item e -->
            <!-- select_list : list_item s -->
            <ul class="slct_list_con">
              <li class="slct_list_item" style="cursor: pointer">
                <div class="radio_stl">
                  <input type="radio" id="gl_radio_dlvr_msg_0" name="gl_radio_dlvr_msg" value="배송 전 연락 바랍니다">
                  <label for="gl_radio_dlvr_msg_0">
                    <div class="slct_con" deliveryrequestmessage="배송 전 연락 바랍니다">
                      배송 전 연락 바랍니다
                    </div>
                  </label>
                </div>
              </li>
              <li class="slct_list_item" style="cursor: pointer">
                <div class="radio_stl">
                  <input type="radio" id="gl_radio_dlvr_msg_1" name="gl_radio_dlvr_msg" value="부재 시 문 앞에 놓아주세요">
                  <label for="gl_radio_dlvr_msg_1">
                    <div class="slct_con" deliveryrequestmessage="부재 시 문 앞에 놓아주세요">
                      부재 시 문 앞에 놓아주세요
                    </div>
                  </label>
                </div>
              </li>
              <li class="slct_list_item" style="cursor: pointer">
                <div class="radio_stl">
                  <input type="radio" id="gl_radio_dlvr_msg_2" name="gl_radio_dlvr_msg" value="부재 시 경비실에 맡겨주세요">
                  <label for="gl_radio_dlvr_msg_2">
                    <div class="slct_con" deliveryrequestmessage="부재 시 경비실에 맡겨주세요">
                      부재 시 경비실에 맡겨주세요
                    </div>
                  </label>
                </div>
              </li>
              <li class="slct_list_item" style="cursor: pointer">
                <div class="radio_stl">
                  <input type="radio" id="gl_radio_dlvr_msg_3" name="gl_radio_dlvr_msg" value="빠른 배송 부탁드립니다">
                  <label for="gl_radio_dlvr_msg_3">
                    <div class="slct_con" deliveryrequestmessage="빠른 배송 부탁드립니다">
                      빠른 배송 부탁드립니다
                    </div>
                  </label>
                </div>
              </li>
              <li class="slct_list_item" style="cursor: pointer">
                <div class="radio_stl">
                  <input type="radio" id="gl_radio_dlvr_msg_4" name="gl_radio_dlvr_msg" value="부재 시 핸드폰으로 연락바랍니다">
                  <label for="gl_radio_dlvr_msg_4">
                    <div class="slct_con" deliveryrequestmessage="부재 시 핸드폰으로 연락바랍니다">
                      부재 시 핸드폰으로 연락바랍니다
                    </div>
                  </label>
                </div>
              </li>
            </ul>
            <!-- select_list : list_item e -->
          </div>
          

          <!-- 211026 공동현관 출입방법 S -->
          <div class="select_list_wrap select_list_dlvr_msg enter-door211026">
            <!-- select_list : selected_item s -->
            <div class="slcted_item">
              <div class="slct_con">
                <span class="gray_fc">공동현관 출입방법을 선택해주세요</span><br>
                <span class="gray_fc2">-문 앞 배송 요청 시 필수사항</span>
              </div>
            </div>
            <!-- select_list : selected_item e -->
            <!-- select_list : list_item s -->
            <ul class="slct_list_con">
              <li class="slct_list_item">
                <div class="radio_stl">
                  <input type="radio" id="enter_door_04" name="frontDoorSelectMessage" value="공동현관 출입번호">
                  <label for="enter_door_04">
                    <div class="slct_con">공동현관 출입번호</div>
                  </label>
                  <input type="text" class="enter_door" id="fdMessage_4" placeholder="예) #12341234# (최대 15자)"
                    onkeyup="chkword('fdMessage_4','frontDoorMessage_text_length',15);"
                    onblur="chkword('fdMessage_4','frontDoorMessage_text_length',15);">
                </div>
              </li>
              <li class="slct_list_item">
                <div class="radio_stl">
                  <input type="radio" id="enter_door_05" name="frontDoorSelectMessage" value="자유 출입 가능">
                  <label for="enter_door_05">
                    <div class="slct_con">자유 출입 가능</div>
                  </label>
                </div>
              </li>
            </ul>
            <!-- select_list : list_item e -->
          </div>
          <!-- 211026 공동현관 출입방법 E -->
          <!-- select_list : 배송지메세지리스트 s -->
        </div>
        <!-- ########## shipping info end ########## -->

        <!-- ########## coupon start ########## -->
        <div class="df_box">
          <h3 class="df_box_tit">쿠폰 및 혜택 적용</h3>
          <div id="voucherArea" class="couponselectArea">
            <div class="text_coupon_slct_wrap online_coupon_box">
              <div class="select_box">
                <select id="selectVoucher" onchange="checkVoucher();">
                  <option value="" data-code="0">쿠폰을 선택해 주세요.</option>
                  <th:block th:if="${#lists.size(coupons)!=0}" th:each="cp, i : ${coupons}">
                    <th:block th:if="${cp.eDiscount < 100}">
                      <option th:value="${cp.cpid}" th:data-code="${cp.eDiscount}">
                        [[${cp.eCouponTitle}]] / [[${cp.eDiscount}]]%
                      </option>
                    </th:block>

                    <th:block th:if="${cp.eDiscount >= 100}">
                      <option th:value="${cp.cpid}" th:data-code="${cp.eDiscount}">
                        [[${cp.eCouponTitle}]] / ₩[[${#numbers.formatInteger(cp.eDiscount, 3, 'COMMA')}]]
                      </option>
                    </th:block>
                  </th:block>
                </select>
              </div>
            </div>
          </div>

          <div class="coupon_insert">
            <input type="text" name="voucherCode" id="voucherCode" placeholder="쿠폰 코드를 입력해 주세요." value="" >
            <a href="#none" class="btnstl2 border_btn_blk btn_input_apply" onclick="selectVoucher();">적용</a>
            <a href="#none" class="btn_input_reset"><span>초기화</span></a>
          </div>

          <div id="pvoucherArea" class="couponselectArea">
          </div>

        </div>
        <!-- ########## coupon end ########## -->

        <!-- ########## mileage start ########## -->
        <div class="df_box" id="secondaryPaymentArea">
          <h3 class="df_box_tit">
            마일리지 사용<!-- tootip s -->
            <span class="dpIB">
              <div class="icon_help btn_tooltip" data-tooltip-target="tooltip_discout_info"> </div>
            </span>
            <!-- tootip : contents_area s -->
            <div class="tooltip_contens">
              <div class="tooltip_wrap tooltip_discout_info" style="display: none;">
                <div class="tltp_close_btn btn_tltp_close"><span>닫기</span></div>
                <h1 class="tltp_header">마일리지 사용</h1>
                <div class="tltp_content">
                  <div class="desc_box">보유 한섬마일리지 금액을 확인하시고 사용하실 금액을 입력 후 [적용]을 선택하세요.</div>
                </div>
              </div>
            </div>
          </h3>

          <!-- ########## mileage tooltip start ########## -->
          <ul class="mpg_list_wrap list_secondary_payment">
            <!-- mileage -->
            <li class="mpg_li_point mt0">
              <div class="mpg_tit">
                마일리지</div>
              <div class="mpg_input">
                <input type="text" id="useMileage" name="useMileage" class="only_number set_comma" data-unit="P"
                  placeholder="0" autocomplete="nope" th:max-point="${mem.mileage}" th:data-max="${mem.mileage}" value="0">
                <a href="#none" class="btnstl2 border_btn_blk btn_input_apply" id="btnUseHPoint" data-poptarget=""
                  onclick="selectMileage();">적용</a>
                <a href="#none" class="btn_input_reset"><span>초기화</span></a>
                <div class="check_stl">
                  <input type="checkbox" id="mpg_all_use_2" onclick="checkMileage();">
                  <label for="mpg_all_use_2">전액사용 (<span>[[${mem.mileage}]]</span> P)</label>
                </div>
              </div>
            </li>
          </ul>
          <!-- ########## mileage tooltip end ########## -->
          <a href="javascript:;" class="btn_popup" data-poptarget="" id="btn_popupgw" style="display:none"></a>
        </div>
        <!-- ########## mileage end ########## -->

        <!-- ########## Payment choose start ########## -->

        <div class="df_box payment_choice_wrap" style="overflow:hidden">
          <h3 class="df_box_tit">결제수단선택</h3>

          <!-- tab_head s -->
          <ul class="ui_tab red_border_tab payment_choice_tab active">
            <li class="pct2 on"><a href="#general_pay"><span>일반결제</span></a></li>
          </ul>

          <!-- tab_head e -->
          <!-- tab_cont s -->
          <div class="tab_cont on">

            <!-- tab_cont : 카드간편결제 s -->
            <!-- tab_cont : 일반결제 s -->
            <div class="cont  on" id="general_pay">
              <div class="general_pay_wrap " style="overflow:hidden;">
                <ul class="general_pay_list gpd_tab_w1">
                  <li class="on"><a href="#none" class="gpd_a_credit" data-kind="credit"
                      data-mode="html5_inicis" onclick="selectPMCompany(this)">신용카드</a></li>
                </ul>
                <ul class="general_pay_list gpd_tab_w3">
                  <li><a href="#none" class="gpd_a_kakakopay" data-kind="kakakopay"
                      data-mode="kakaopay" onclick="selectPMCompany(this)">카카오페이</a></li>
                  <li><a href="#none" class="gpd_a_tosspay" data-kind="tosspay" data-mode="kakaopay" onclick="selectPMCompany(this)">토스</a>
                  </li>
                </ul>
              </div>
            </div>
            <!-- tab_cont : 일반결제 e -->
          </div>
          <!-- tab_cont e -->
          <!-- guide s -->
          <ul class="shoppingbag_guide_wrap btn_wrap btn_wrap_div1 ta_c" id="cardBenefit" style="display: block;">
            <li>
              <a href=".product_card_pop" class="btnstl5 arrow_btn spb_card_benefit btn_popup_trigger">
                <span>카드 행사 혜택(무이자, 청구, 즉시할인)</span>
              </a>
            </li>
          </ul>

          <div class="hympoint_banner_wrap" style="display: block;height: 99;">
            <div class="hympoint_banner" style="margin-top:23px;height: 100%;">
              <div class="img">
                <img src="http://cdn.thehandsome.com/mobile/hyundai_mpointcard.png" alt="현대카드 Mpoint">
              </div>
              <p>
                현대카드 M카드계열 결제 시,<br>
                최종 결제금액의 10%(최대 3만원)<br>
                M포인트로 사용 가능<br>
                <span>(자세한 내용 이벤트 페이지 참고)</span>
              </p>
            </div>
          </div>
          <!-- guide e -->
        </div>
        <!-- ########## Payment choose end ########## -->

        <!-- ########## final price start ########## -->
        <div id="checkoutCartTotalPrice">
          <div class="df_box total_price_wrap">
            <h3 class="df_box_tit">
              최종 결제금액
              <div class="pay_price">₩0</div>
            </h3>

            <ul class="total_price_detail">

              <li id="subtotal" class="sub_total190816">
                <div class="ttpd_tit">상품 합계</div>
                <div class="ttpd_con" id="ttpd_con1">₩0</div>
              </li>

              <li>
                <div class="ttpd_tit">프로모션/쿠폰</div>
                <div class="ttpd_con" id="ttpd_con2">- ₩0</div>
              </li>
              <li>
                <div class="ttpd_tit">
                  배송비<!-- tootip s -->
                  <span class="dpIB">
                    <div class="icon_help btn_tooltip" data-tooltip-target="tooltip_buy_delivery_charge"></div>
                  </span>
                  <!-- tootip : contents_area s -->
                  <div class="tooltip_contens">
                    <div class="tooltip_wrap tooltip_buy_delivery_charge" style="display: none;">
                      <div class="tltp_close_btn btn_tltp_close"><span>닫기</span></div>
                      <h1 class="tltp_header">배송비</h1>
                      <div class="tltp_content">
                        <ul class="ul_dot_blk">
                          <li>쿠폰/바우처 할인금액 및 한섬마일리지/H.Point 사용을 제외한 실 결제금액 기준 <strong>3만원 미만 결제 시 2,500원 배송비가
                              부과</strong>됩니다. (3만원 이상 구매 시 무료배송)</li>
                          <li>도서산간 지역은 배송비가 추가 될 수 있습니다.</li>
                          <li>한섬마일리지, H.Point, e-money로 배송비 결제가 불가합니다.</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <!-- tootip : contents_area e -->
                  <!-- tootip e -->

                </div>

                <div class="ttpd_con" id="ttpd_con3">₩ 0</div>
              </li>
            </ul>


          </div>
          <input type="hidden" name="beforeprice" id="beforeprice" value="" />
          <input type="hidden" name="afterprice" id="afterprice" value="" />
          <input type="hidden" id="customDueAmount" value="0" />
          <input type="hidden" name="pmCompany" id="pmCompany" value="credit" />
          <input type="hidden" name="pmCode" id="pmCode" value="" /> 
          <input type="hidden" name="phone" id="phone" value="" /> 
        </div>
        <!-- ########## final price end ########## -->


        <!-- ########## add point info start ########## -->
        <div class="df_box">
          <h3 class="df_box_tit">
            적립 예정 포인트
            <!-- tootip s -->
            <span class="dpIB">
              <div class="icon_help btn_tooltip" data-tooltip-target="tooltip_buy_point_guide"></div>
            </span>
            <!-- tootip : contents_area s -->
            <div class="tooltip_contens">
              <div class="tooltip_wrap tooltip_buy_point_guide" style="display: none;">
                <div class="tltp_close_btn btn_tltp_close"><span>닫기</span></div>
                <h1 class="tltp_header">적립 예정 포인트</h1>
                <div class="tltp_content">
                  <ul class="ul_dot_blk">
                    <li>기존 마이너스 포인트를 보유하고 있는 고객은 포인트가 차감되어 적립됩니다. 적립 예정 포인트가 상이할 수 있습니다.</li>
                    <li>통합 멤버쉽으로 가입하시면, H.Point 적립 및 사용이 가능합니다.</li>
                  </ul>
                </div>
              </div>
            </div>
            <!-- tootip : contents_area e -->
            <!-- tootip e -->
          </h3>

          <div class="tooltip_html">
            <div class="tooltip_wrap tooltip_buy_point_guide">
              <div class="tltp_close_btn btn_tltp_close"><span>닫기</span></div>
              <h1 class="tltp_header">적립 예정 포인트</h1>
              <div class="tltp_content">
                <ul class="ul_dot_blk">
                  <li>기존 마이너스 포인트를 보유하고 있는 고객은 포인트가 차감되어 적립됩니다. 적립 예정 포인트가 상이할 수 있습니다.</li>
                  <li>통합 멤버쉽으로 가입하시면, H.Point 적립 및 사용이 가능합니다.</li>
                </ul>
              </div>
            </div>
          </div>

          <ul class="ul_dot point_back_wrap ">
            <li>
              <div class="udot_tit">한섬마일리지</div>
              <div class="udot_con"><span id="txtAccumulationPoint">48,800</span> M</div>
            </li>
          </ul>
        </div>
        <!-- ########## add point info end ########## -->

        <!-- ########## Buyer Agreement start ########## -->
        <div class="df_box df_box_slide agree_buyer_wrap">
          <div class="check_stl df_box_tit">
            <input type="checkbox" id="agree" value="false">
            <label for="agree">
              <h3 class="df_box_tit">[필수] 구매자 동의</h3>
            </label>
          </div>
          <div class="df_box_slide_con desc_box"
            style="display: none; height: 34px; padding-top: 0px; margin-top: 15px; padding-bottom: 0px; margin-bottom: 0px;">
            주문할 상품의 상품명, 가격, 배송정보 등을 확인하였으며, <br>구매 진행에 동의합니다. (전자상거래법 제 8조 2항)</div>
        </div>
        <!-- ########## Buyer Agreement end ########## -->

        <!-- ########## Payment button start ########## -->
        <div class="df_box payment_btn_wrap last_box fs1904">
          <div class="btn_desc_oera">
            <p>
              먼저 준비된 상품부터 순차적으로 발송하므로, <br>부분 배송될 수 있습니다.</p>
          </div>
          <ul class="btn_wrap btn_wrap_div1">
            <li class="pymt_call_pg">
              <a href="#none" class="btnstl6 solid_btn_point" id="doOrderBtn" onclick="submitOrder()"><span><b>0</b>
                  원&nbsp;주문하기</span></a>
            </li>
          </ul>
        </div>
        <!-- ########## Payment button end ########## -->

        <!-- ########## footer add ########## -->
        <footer th:replace="wck/includes/footer :: fragment-footer"></footer>

      </div>
      <!-- ########## contents end ########## -->

    </div>
  </div>

  <div class="divpop_wrap_dev pop_mbr pop_alert_confirm" id="popAlertConfirmDiv"
    style="left: 0px; position: fixed; top: 101px; z-index: 9999; opacity: 1; display: none;">
    <div class="dvp_container">
      <div class="dvp_close_btn b-close" id="confirmCloseDiv"><span>닫기</span></div>
      <div class="dvp_content">
        <div class="desc_box"></div>
      </div>
      <div class="btn_wrap btns"> <button class="btn btn_bd_g btn-alert-close"></button> <button
          class="btn btn_bg_b btn-alert-confirm"></button> </div>
    </div>
  </div>


</form>

</body>

</html>